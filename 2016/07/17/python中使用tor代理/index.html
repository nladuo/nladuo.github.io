<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> python中使用tor代理 · 叁公子的博客</title><meta name="description" content="python中使用tor代理 - 叁公子"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="../../../../avatar.jpg"><link rel="stylesheet" href="../../../../css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://nladuo.github.io/atom.xml" title="叁公子的博客"></head><body><div class="wrap"><header><a href="../../../../index.html" class="logo-link"><img src="/avatar.jpg"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/nladuo" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="http://weibo.com/u/2780483203" target="_blank" class="nav-list-link">WEIBO</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">python中使用tor代理</h1><div class="post-info">Jul 17, 2016</div><div class="post-content"><h2 id="&#x8BF4;&#x660E;"><a href="#&#x8BF4;&#x660E;" class="headerlink" title="&#x8BF4;&#x660E;"></a>&#x8BF4;&#x660E;</h2><p>&#x672C;&#x6587;&#x53C2;&#x8003;&#x81EA;:<br><a href="http://ningning.today/2016/03/07/python/python-requests-tor-crawler/" target="_blank" rel="external">http://ningning.today/2016/03/07/python/python-requests-tor-crawler/</a><br><a href="http://stackoverflow.com/questions/6216653/how-to-let-tor-change-ip-automatically" target="_blank" rel="external">http://stackoverflow.com/questions/6216653/how-to-let-tor-change-ip-automatically</a></p>
<h2 id="&#x5DE5;&#x5177;"><a href="#&#x5DE5;&#x5177;" class="headerlink" title="&#x5DE5;&#x5177;"></a>&#x5DE5;&#x5177;</h2><p>&#x56FD;&#x5916;ubuntu&#x670D;&#x52A1;&#x5668;&#x4E00;&#x53F0;&#x3002;</p>
<a id="more"></a>
<h2 id="&#x5B89;&#x88C5;"><a href="#&#x5B89;&#x88C5;" class="headerlink" title="&#x5B89;&#x88C5;"></a>&#x5B89;&#x88C5;</h2><p>1&#x3001;&#x5B89;&#x88C5;tor<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apt-get update &amp;&amp; apt-get install tor</div></pre></td></tr></table></figure></p>
<p>2&#x3001;&#x751F;&#x6210;&#x5BC6;&#x7801;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tor --hash-password mypassword</div></pre></td></tr></table></figure></p>
<p>3&#x3001;&#x7F16;&#x8F91;/etc/tor/torrc&#xFF0C;&#x52A0;&#x4E0A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ControlPort 9051</div><div class="line">HashedControlPassword 16:872860B76453A77D60CA2BB8C1A7042072093276A3D701AD684053EC4C</div><div class="line">MaxCircuitDirtiness 10</div></pre></td></tr></table></figure></p>
<p>16&#x540E;&#x9762;&#x7684;hash&#x6839;&#x636E;&#x4E0A;&#x4E00;&#x6761;&#x547D;&#x4EE4;&#x751F;&#x6210;&#x7684;hash&#x6765;&#x4FEE;&#x6539;&#xFF0C; MaxCircuitDirtiness 10&#x4EE3;&#x8868;10&#x79D2;&#x66F4;&#x6362;&#x4E00;&#x6B21;ip&#xFF0C;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x3002;<br>4&#x3001;&#x91CD;&#x542F;tor&#x670D;&#x52A1;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/etc/init.d/tor restart</div></pre></td></tr></table></figure></p>
<h2 id="&#x7F16;&#x5199;&#x4EE3;&#x7801;"><a href="#&#x7F16;&#x5199;&#x4EE3;&#x7801;" class="headerlink" title="&#x7F16;&#x5199;&#x4EE3;&#x7801;"></a>&#x7F16;&#x5199;&#x4EE3;&#x7801;</h2><p>&#x4EE3;&#x7801;&#x57FA;&#x672C;&#x4E0A;&#x6765;&#x81EA;<a href="http://ningning.today/2016/03/07/python/python-requests-tor-crawler/" target="_blank" rel="external">http://ningning.today/2016/03/07/python/python-requests-tor-crawler/</a> &#xFF0C;&#x4F46;&#x662F;&#x53D1;&#x73B0;&#x4E0D;&#x80FD;&#x7528;&#xFF0C;&#x53EA;&#x4FEE;&#x6539;&#x4E86;&#x51E0;&#x884C;&#x3002;<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding:utf-8 -*-</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> requesocks</div><div class="line"><span class="keyword">import</span> time</div><div class="line"></div><div class="line">url = <span class="string">&apos;https://api.ipify.org?format=json&apos;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getip_requests</span><span class="params">(url)</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">&quot;(+) Sending request with plain requests...&quot;</span></div><div class="line">    r = requests.get(url)</div><div class="line">    <span class="keyword">print</span> <span class="string">&quot;(+) IP is: &quot;</span> + r.text.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getip_requesocks</span><span class="params">(url)</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">&quot;(+) Sending request with requesocks...&quot;</span></div><div class="line">    session = requesocks.session()</div><div class="line">    session.proxies = {<span class="string">&apos;http&apos;</span>: <span class="string">&apos;socks5://127.0.0.1:9050&apos;</span>,</div><div class="line">                       <span class="string">&apos;https&apos;</span>: <span class="string">&apos;socks5://127.0.0.1:9050&apos;</span>}</div><div class="line">    r = session.get(url)</div><div class="line">    <span class="keyword">print</span> <span class="string">&quot;(+) IP is: &quot;</span> + r.text.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">&quot;Running tests...&quot;</span></div><div class="line">    getip_requests(url)</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        getip_requesocks(url)</div><div class="line">        time.sleep(<span class="number">10</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure></p>
<h2 id="&#x6548;&#x679C;"><a href="#&#x6548;&#x679C;" class="headerlink" title="&#x6548;&#x679C;"></a>&#x6548;&#x679C;</h2><p><img src="/2016/07/17/python&#x4E2D;&#x4F7F;&#x7528;tor&#x4EE3;&#x7406;/ip_change.png" alt="ip_change"><br>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x662F;&#x81EA;&#x5DF1;&#x7684;ip&#xFF0C;&#x4E4B;&#x540E;&#x662F;&#x4F7F;&#x7528;tor&#x4EE3;&#x7406;&#x83B7;&#x5F97;&#x7684;ip&#xFF0C;&#x6BCF;&#x5341;&#x79D2;&#x6362;&#x4E00;&#x4E2A;&#x3002;</p>
</div></article></div></section><footer><div class="paginator"><a href="../../../08/24/一个物联网入门教程——IoT-Firstep/" class="prev">PREV</a><a href="../../../06/28/验证码破解四部曲之环境搭建篇/" class="next">NEXT</a></div><div data-thread-key="2016/07/17/python中使用tor代理/" data-title="python中使用tor代理" data-url="http://nladuo.github.io/2016/07/17/python中使用tor代理/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"true"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2015 - 2017 <a href="http://nladuo.github.io">叁公子</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>