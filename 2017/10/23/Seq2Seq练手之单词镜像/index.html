<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><script src="http://tx.nladuo.cn:3000/analytics.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><title>Seq2Seq练手之单词镜像 · 叁公子的博客</title><meta name="description" content="Seq2Seq练手之单词镜像 - 叁公子"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="../../../../avatar.jpg"><link rel="stylesheet" href="../../../../css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://nladuo.github.io/atom.xml" title="叁公子的博客"></head><body><div class="wrap"><header><a href="../../../../index.html" class="logo-link"><img src="../../../../avatar.jpg" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="../../../../index.html" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="../../../../archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/nladuo" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Seq2Seq练手之单词镜像</h1><div class="post-info">Oct 23, 2017</div><div class="post-content"><h2 id="&#x8D77;&#x6E90;"><a href="#&#x8D77;&#x6E90;" class="headerlink" title="&#x8D77;&#x6E90;"></a>&#x8D77;&#x6E90;</h2><p>&#x6700;&#x8FD1;&#x5728;&#x505A;Web&#x5B89;&#x5168;&#x6280;&#x672F;&#x7684;&#x5927;&#x4F5C;&#x4E1A;&#xFF0C;&#x5927;&#x4F5C;&#x4E1A;&#x662F;&#x505A;&#x5BC6;&#x7801;&#x5206;&#x6790;&#x7684;&#x4E1C;&#x897F;&#xFF0C;&#x4E00;&#x4E2A;&#x5BC6;&#x7801;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x4E00;&#x4E2A;&#x5E8F;&#x5217;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;NLP&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x5728;&#x5927;&#x4F5C;&#x4E1A;&#x4E2D;&#xFF0C;&#x6709;&#x4E2A;&#x4EFB;&#x52A1;&#x8981;&#x505A;&#x4E2D;&#x6587;&#x5206;&#x6790;&#xFF0C;&#x6BD4;&#x5982;&#x51FA;&#x73B0;&#x4E86;&#x54EA;&#x4E2A;&#x4E2D;&#x6587;&#x5B57;&#x3002;&#x6BD4;&#x5982;&#xFF0C;&#x5BC6;&#x7801;&#x4E2D;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x201C;woainixxxx&#x201D;&#x8FD9;&#x6837;&#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x5982;&#x4F55;&#x91CC;&#x9762;&#x7684;&#x4E2D;&#x6587;&#x62FC;&#x97F3;&#x5206;&#x5F00;&#xFF0C;&#x8FD9;&#x91CC;&#x60F3;&#x5230;&#x4E86;Seq2Seq&#x6A21;&#x578B;&#xFF0C;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x53EF;&#x4EE5;&#x662F;&#x201C;woaini&#x201D;&#xFF0C;&#x7136;&#x540E;&#x8F93;&#x51FA;&#x4E3A;&#x201C;wo ai ni&#x201D;&#xFF0C;&#x8BA9;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5E2E;&#x6211;&#x4EEC;&#x52A0;&#x4E0A;&#x7A7A;&#x683C;&#x3002;</p>
<h2 id="&#x4EFB;&#x52A1;"><a href="#&#x4EFB;&#x52A1;" class="headerlink" title="&#x4EFB;&#x52A1;"></a>&#x4EFB;&#x52A1;</h2><p>&#x8FD9;&#x91CC;&#x5148;&#x60F3;&#x5230;&#x4E86;&#x4E4B;&#x524D;&#x5B66;Udacity&#x7684;ud730&#x7684;LSTM&#x65F6;&#x5019;&#x7559;&#x7684;&#x4F5C;&#x4E1A;&#xFF0C;&#x4E4B;&#x524D;&#x4E00;&#x76F4;&#x6CA1;&#x6709;&#x505A;&#x3002;&#x611F;&#x89C9;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x597D;&#x4F8B;&#x5B50;&#xFF0C;&#x4E0D;&#x8FC7;&#x6709;&#x70B9;&#x513F;&#x96BE;&#xFF0C;&#x6682;&#x65F6;&#x6CA1;&#x53BB;&#x7528;TensorFlow&#x6765;&#x539F;&#x751F;&#x5B9E;&#x73B0;&#xFF0C;&#x8FD9;&#x91CC;&#x5C06;&#x4F7F;&#x7528;Keras&#x6765;&#x505A;&#x3002;</p>
<p><img src="/2017/10/23/Seq2Seq&#x7EC3;&#x624B;&#x4E4B;&#x5355;&#x8BCD;&#x955C;&#x50CF;/task.png" alt="task"></p>
<blockquote>
<p>&#x8FD9;&#x91CC;&#x7684;&#x4EFB;&#x52A1;&#x662F;&#x5355;&#x8BCD;&#x955C;&#x50CF;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x628A;&#x5355;&#x8BCD;&#x53CD;&#x8F6C;&#x4E00;&#x4E0B;&#x3002;<br><a id="more"></a></p>
</blockquote>
<h2 id="&#x4EE3;&#x7801;"><a href="#&#x4EE3;&#x7801;" class="headerlink" title="&#x4EE3;&#x7801;"></a>&#x4EE3;&#x7801;</h2><p>&#x4EE3;&#x7801;&#x4EE5;jupyter notebook&#x5F62;&#x5F0F;&#x653E;&#x5728;&#x4E86;<a href="https://github.com/nladuo/ml-study-stuff/blob/master/udacity/Deep-Learning/mirror_the_words.ipynb" target="_blank" rel="external">https://github.com/nladuo/ml-study-stuff/blob/master/udacity/Deep-Learning/mirror_the_words.ipynb</a></p>
<h2 id="&#x6784;&#x5EFA;&#x6570;&#x636E;&#x96C6;"><a href="#&#x6784;&#x5EFA;&#x6570;&#x636E;&#x96C6;" class="headerlink" title="&#x6784;&#x5EFA;&#x6570;&#x636E;&#x96C6;"></a>&#x6784;&#x5EFA;&#x6570;&#x636E;&#x96C6;</h2><h4 id="&#x53D6;&#x6570;&#x636E;"><a href="#&#x53D6;&#x6570;&#x636E;" class="headerlink" title="&#x53D6;&#x6570;&#x636E;"></a>&#x53D6;&#x6570;&#x636E;</h4><p>&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x5148;&#x6784;&#x5EFA;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x4E86;&#x4E4B;&#x524D;&#x7684;text8&#x3002;text8&#x91CC;&#x9762;&#x4E00;&#x5171;&#x6709;1&#x4EBF;&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x662F;&#x505A;&#x4E2A;demo&#xFF0C;&#x6570;&#x636E;&#x53D6;&#x5C11;&#x4E00;&#x70B9;&#x513F;&#xFF0C;&#x6211;&#x53D6;&#x4E86;1&#x4E07;&#x4E2A;&#x5B57;&#x7B26;&#x4F5C;&#x4E3A;&#x6D4B;&#x8BD5;&#x6570;&#x636E;&#xFF0C;200&#x4E07;&#x5B57;&#x7B26;&#x4F5C;&#x4E3A;&#x8BAD;&#x7EC3;&#x6570;&#x636E;&#x3002;<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">valid_size = <span class="number">10000</span></div><div class="line">train_size = <span class="number">2000000</span></div><div class="line">valid_text = text[:valid_size]</div><div class="line">train_text = text[valid_size:valid_size+train_size]</div><div class="line">train_size = len(train_text)</div></pre></td></tr></table></figure></p>
<p><img src="/2017/10/23/Seq2Seq&#x7EC3;&#x624B;&#x4E4B;&#x5355;&#x8BCD;&#x955C;&#x50CF;/code1.png" alt="code1.png"></p>
<h4 id="&#x5B57;&#x7B26;&#x6570;&#x5B57;&#x8F6C;&#x6362;"><a href="#&#x5B57;&#x7B26;&#x6570;&#x5B57;&#x8F6C;&#x6362;" class="headerlink" title="&#x5B57;&#x7B26;&#x6570;&#x5B57;&#x8F6C;&#x6362;"></a>&#x5B57;&#x7B26;&#x6570;&#x5B57;&#x8F6C;&#x6362;</h4><p>&#x5728;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#xFF0C;&#x53D6;&#x503C;&#x90FD;&#x662F;&#x6570;&#x503C;&#x578B;&#x7684;&#xFF0C;&#x53EA;&#x6709;&#x5C0F;&#x5199;&#x5B57;&#x7B26;&#x548C;&#x7A7A;&#x683C;&#x4E24;&#x79CD;&#xFF0C;&#x4E5F;&#x662F;&#x5C31;&#x662F;26+1&#x4E2D;&#x5B57;&#x7B26;&#x3002;<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># &#x5C06;&#x5B57;&#x7B26;&#x8F6C;&#x4E3A;id</span></div><div class="line"><span class="keyword">import</span> string</div><div class="line"></div><div class="line">vocabulary_size = len(string.ascii_lowercase) + <span class="number">1</span> <span class="comment"># [a-z] + &apos; &apos;</span></div><div class="line">first_letter = ord(string.ascii_lowercase[<span class="number">0</span>])</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">char2id</span><span class="params">(char)</span>:</span></div><div class="line">  <span class="keyword">if</span> char <span class="keyword">in</span> string.ascii_lowercase:</div><div class="line">    <span class="keyword">return</span> ord(char) - first_letter + <span class="number">1</span></div><div class="line">  <span class="keyword">elif</span> char == <span class="string">&apos; &apos;</span>:</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span></div><div class="line">  <span class="keyword">else</span>:</div><div class="line">    print(<span class="string">&apos;Unexpected character: %s&apos;</span> % char)</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">id2char</span><span class="params">(dictid)</span>:</span></div><div class="line">  <span class="keyword">if</span> dictid &gt; <span class="number">0</span>:</div><div class="line">    <span class="keyword">return</span> chr(dictid + first_letter - <span class="number">1</span>)</div><div class="line">  <span class="keyword">else</span>:</div><div class="line">    <span class="keyword">return</span> <span class="string">&apos; &apos;</span></div></pre></td></tr></table></figure></p>
<p><img src="/2017/10/23/Seq2Seq&#x7EC3;&#x624B;&#x4E4B;&#x5355;&#x8BCD;&#x955C;&#x50CF;/code2.png" alt="code2.png"></p>
<h4 id="&#x6784;&#x5EFA;Label"><a href="#&#x6784;&#x5EFA;Label" class="headerlink" title="&#x6784;&#x5EFA;Label"></a>&#x6784;&#x5EFA;Label</h4><p>&#x6211;&#x4EEC;&#x8981;&#x505A;&#x5355;&#x8BCD;&#x955C;&#x50CF;&#xFF0C;&#x8FD9;&#x5728;&#x4EE3;&#x7801;&#x4E2D;&#x5F88;&#x597D;&#x5B9E;&#x73B0;&#x3002;&#x955C;&#x50CF;&#x540E;&#x7684;text&#x4E5F;&#x5C31;&#x662F;&#x8BAD;&#x7EC3;&#x7684;&#x6807;&#x7B7E;&#x3002;<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">mirror</span><span class="params">(text)</span>:</span></div><div class="line">    words = text.split(<span class="string">&quot; &quot;</span>)</div><div class="line">    mirror = []</div><div class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> words:</div><div class="line">        mirror.append(word[::<span class="number">-1</span>])</div><div class="line">    <span class="keyword">return</span> <span class="string">&quot; &quot;</span>.join(mirror)</div></pre></td></tr></table></figure></p>
<p><img src="/2017/10/23/Seq2Seq&#x7EC3;&#x624B;&#x4E4B;&#x5355;&#x8BCD;&#x955C;&#x50CF;/code3.png" alt="code3.png"></p>
<h4 id="&#x6784;&#x5EFA;dataset&#x548C;labels"><a href="#&#x6784;&#x5EFA;dataset&#x548C;labels" class="headerlink" title="&#x6784;&#x5EFA;dataset&#x548C;labels"></a>&#x6784;&#x5EFA;dataset&#x548C;labels</h4><p>&#x4E0B;&#x9762;&#xFF0C;&#x6211;&#x4EEC;&#x628A;text&#x62C6;&#x5F00;&#xFF0C;20&#x4E2A;&#x4E3A;&#x4E00;&#x7EC4;&#xFF0C;&#x4F5C;&#x4E3A;dataset&#xFF1B;&#x628A;20&#x4E2A;&#x5B57;&#x7B26;&#x53D6;&#x4E00;&#x4E2A;mirror&#xFF0C;&#x5C31;&#x6210;&#x4E86;labels<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">seq_len = <span class="number">20</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_dataset</span><span class="params">(text)</span>:</span></div><div class="line">    dataset = []</div><div class="line">    labels = []</div><div class="line">    length = len(text) / seq_len</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(length):</div><div class="line">        line = text[i:i+seq_len]</div><div class="line">        mirror_line = mirror(line)</div><div class="line">        dataset.append([char2id(ch) <span class="keyword">for</span> ch <span class="keyword">in</span> line])</div><div class="line">        labels.append([char2id(ch) <span class="keyword">for</span> ch <span class="keyword">in</span> mirror_line])</div><div class="line">    <span class="keyword">return</span> dataset, labels</div><div class="line"></div><div class="line">train_set, train_labels = build_dataset(train_text)</div><div class="line">valid_set, valid_labels = build_dataset(valid_text)</div></pre></td></tr></table></figure></p>
<p>&#x7136;&#x540E;&#xFF0C;&#x8FDB;&#x884C;One-Hot&#x7F16;&#x7801;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;&#x5982;&#x679C;&#x6570;&#x636E;&#x6709;&#x4E09;&#x7C7B;&#xFF0C;0&#x7F16;&#x7801;&#x6210;[0 0 1], 1&#x7F16;&#x7801;&#x6210;[0 1 0]&#xFF0C;2&#x7F16;&#x7801;&#x6210;[1 0 0]&#x3002;&#x8FD9;&#x91CC;&#x4E00;&#x5171;&#x6709;27&#x79CD;&#x5B57;&#x7B26;&#xFF0C;&#x6240;&#x4EE5;&#x662F;&#x4E00;&#x4E2A;&#x957F;&#x5EA6;&#x4E3A;27&#x7684;&#x5411;&#x91CF;&#x3002;<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">vectorize</span><span class="params">(word, seq_len, vec_size)</span>:</span></div><div class="line">    vec = np.zeros((seq_len, vec_size), dtype=int)</div><div class="line">    <span class="keyword">for</span> i, ch <span class="keyword">in</span> enumerate(word):</div><div class="line">        vec[i, ch] = <span class="number">1</span></div><div class="line">    <span class="keyword">return</span> vec</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">vectorize_dataset</span><span class="params">(dataset, labels)</span>:</span></div><div class="line">    x = np.zeros((len(dataset), seq_len, vocabulary_size), dtype=np.int8)</div><div class="line">    y = np.zeros((len(dataset), seq_len, vocabulary_size), dtype=np.int8)</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(dataset)):</div><div class="line">        x[i] = vectorize(dataset[i], seq_len, vocabulary_size)</div><div class="line">        y[i] = vectorize(labels[i], seq_len, vocabulary_size)</div><div class="line">    <span class="keyword">return</span> x, y</div><div class="line"></div><div class="line">train_x, train_y = vectorize_dataset(train_set, train_labels)</div><div class="line">valid_x, valid_y = vectorize_dataset(valid_set, valid_labels)</div></pre></td></tr></table></figure></p>
<p><img src="/2017/10/23/Seq2Seq&#x7EC3;&#x624B;&#x4E4B;&#x5355;&#x8BCD;&#x955C;&#x50CF;/code4.png" alt="code4.png"></p>
<p>&#x5230;&#x8FD9;&#x91CC;&#xFF0C;&#x6570;&#x636E;&#x96C6;&#x5C31;&#x6784;&#x5EFA;&#x597D;&#x4E86;&#x3002;</p>
<h2 id="&#x8BAD;&#x7EC3;&#x4E0E;&#x6D4B;&#x8BD5;"><a href="#&#x8BAD;&#x7EC3;&#x4E0E;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x8BAD;&#x7EC3;&#x4E0E;&#x6D4B;&#x8BD5;"></a>&#x8BAD;&#x7EC3;&#x4E0E;&#x6D4B;&#x8BD5;</h2><h4 id="&#x6784;&#x5EFA;&#x6A21;&#x578B;"><a href="#&#x6784;&#x5EFA;&#x6A21;&#x578B;" class="headerlink" title="&#x6784;&#x5EFA;&#x6A21;&#x578B;"></a>&#x6784;&#x5EFA;&#x6A21;&#x578B;</h4><p>&#x8FD9;&#x91CC;&#x8981;&#x5EFA;&#x7ACB;seq2seq&#x7F51;&#x7EDC;&#x6A21;&#x578B;&#x4E86;&#xFF0C;&#x8FD9;&#x91CC;&#x53C2;&#x8003;&#x4E86;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;:<a href="http://www.zmonster.me/2016/05/29/sequence_to_sequence_with_keras.html" target="_blank" rel="external">&#x4F7F;&#x7528; Keras &#x5B9E;&#x73B0;&#x7B80;&#x5355;&#x7684; Sequence to Sequence &#x6A21;&#x578B;</a></p>
<p>&#x6A21;&#x578B;&#x91CC;&#x6709;&#x4E2A;RNN&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;RNN&#x4F5C;&#x4E3A;Encoder&#xFF0C;&#x7136;&#x540E;&#x628A;&#x7B2C;&#x4E00;&#x5C42;&#x7684;&#x8F93;&#x51FA;&#x590D;&#x5236;20&#x4EFD;(&#x6570;&#x636E;&#x7684;&#x957F;&#x5EA6;)&#xFF0C;&#x7136;&#x540E;&#x4F5C;&#x4E3A;&#x7B2C;&#x4E8C;&#x4E2A;RNN(Decoder)&#xFF0C;&#x6700;&#x540E;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x5E8F;&#x5217;&#x7684;&#x8F93;&#x51FA;&#x3002;<br><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> keras.layers.recurrent <span class="keyword">import</span> GRU</div><div class="line"><span class="keyword">from</span> keras.layers.wrappers <span class="keyword">import</span> TimeDistributed</div><div class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential, model_from_json</div><div class="line"><span class="keyword">from</span> keras.layers.core <span class="keyword">import</span> Dense, RepeatVector</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_model</span><span class="params">(input_size, seq_len, hidden_size)</span>:</span></div><div class="line">    model = Sequential()</div><div class="line">    model.add(GRU(input_shape=(<span class="keyword">None</span>, input_size), units=hidden_size, return_sequences=<span class="keyword">False</span>))</div><div class="line">    model.add(Dense(hidden_size, activation=<span class="string">&quot;relu&quot;</span>))</div><div class="line">    model.add(RepeatVector(seq_len))</div><div class="line">    model.add(GRU(units=hidden_size, return_sequences=<span class="keyword">True</span>))</div><div class="line">    model.add(TimeDistributed(Dense(units=input_size, activation=<span class="string">&quot;linear&quot;</span>)))</div><div class="line">    model.compile(loss=<span class="string">&quot;mse&quot;</span>, optimizer=<span class="string">&apos;adam&apos;</span>)</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> model</div><div class="line"></div><div class="line">model = build_model(vocabulary_size, seq_len, <span class="number">128</span>)</div></pre></td></tr></table></figure></p>
<h4 id="&#x8BAD;&#x7EC3;"><a href="#&#x8BAD;&#x7EC3;" class="headerlink" title="&#x8BAD;&#x7EC3;"></a>&#x8BAD;&#x7EC3;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">model.fit(train_x, train_y,</div><div class="line">          batch_size=128, </div><div class="line">          epochs=128,</div><div class="line">          verbose=1,</div><div class="line">          validation_data=(valid_x, valid_y))</div></pre></td></tr></table></figure>
<p>&#x8FD9;&#x91CC;&#x4F7F;&#x7528;fit&#x5C31;&#x597D;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FED;&#x4EE3;&#x6B21;&#x6570;&#x589E;&#x52A0;&#xFF0C;loss&#x964D;&#x4F4E;&#x3002;<br><img src="/2017/10/23/Seq2Seq&#x7EC3;&#x624B;&#x4E4B;&#x5355;&#x8BCD;&#x955C;&#x50CF;/model1.png" alt="model1.png"></p>
<h4 id="&#x6548;&#x679C;"><a href="#&#x6548;&#x679C;" class="headerlink" title="&#x6548;&#x679C;"></a>&#x6548;&#x679C;</h4><p>&#x6700;&#x540E;&#x770B;&#x4E00;&#x4E0B;&#x6548;&#x679C;&#xFF0C;&#x867D;&#x7136;&#x6548;&#x679C;&#x4E0D;&#x662F;&#x5B8C;&#x5168;&#x6B63;&#x786E;&#xFF0C;&#x4F46;&#x662F;&#x8FD8;&#x6709;&#x90A3;&#x4E48;&#x70B9;&#x513F;&#x610F;&#x601D;&#x7684;&#x3002;<br><img src="/2017/10/23/Seq2Seq&#x7EC3;&#x624B;&#x4E4B;&#x5355;&#x8BCD;&#x955C;&#x50CF;/result.png" alt="result.png"></p>
<p>&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5B8C;&#x5168;&#x4ECE;0&#x3001;1&#x5B66;&#x4E60;&#x51FA;&#x6765;&#x80FD;&#x505A;&#x5230;&#x8FD9;&#x79CD;&#x6548;&#x679C;&#x4E5F;&#x7B97;&#x662F;&#x4E0D;&#x9519;&#x4E86;&#x3002;</p>
</div></article></div></main><footer><div class="paginator"><a href="../../../11/09/读论文Alogorithms-for-Non-negative-Matrix-Factorization/" class="prev">PREV</a><a href="../../02/冬天又要到了，自己动手DIY一个PM2-5检测仪把！/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'seansun';
var disqus_identifier = '2017/10/23/Seq2Seq练手之单词镜像/';
var disqus_title = 'Seq2Seq练手之单词镜像';
var disqus_url = 'http://nladuo.github.io/2017/10/23/Seq2Seq练手之单词镜像/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//seansun.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2018 <a href="http://nladuo.github.io">叁公子</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>